<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hand Gesture Detector</title>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #0c4a6e 0%, #581c87 50%, #831843 100%);
            color: white;
            padding: 2rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 2rem;
        }

        .header h1 {
            font-size: 3rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }

        .header p {
            color: #93c5fd;
            font-size: 1.125rem;
        }

        .grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
        }

        @media (min-width: 768px) {
            .grid {
                grid-template-columns: 1fr 1fr;
            }
        }

        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(20px);
            border-radius: 1rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            padding: 1.5rem;
        }

        .card h2 {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 1rem;
        }

        .video-container {
            position: relative;
            aspect-ratio: 16/9;
            background: #111827;
            border-radius: 0.75rem;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        #videoElement {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: none;
        }

        #canvasElement {
            width: 100%;
            height: 100%;
            display: block;
        }

        .video-placeholder {
            position: absolute;
            inset: 0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .error-message {
            margin-top: 1rem;
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid rgba(239, 68, 68, 0.5);
            border-radius: 0.5rem;
            padding: 0.75rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .error-message.hidden {
            display: none;
        }

        .button-group {
            display: flex;
            gap: 0.75rem;
            margin-top: 1rem;
        }

        button {
            flex: 1;
            padding: 0.75rem 1.5rem;
            border-radius: 0.5rem;
            border: none;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .start-btn {
            background: #10b981;
            color: white;
        }

        .start-btn:hover {
            background: #059669;
        }

        .stop-btn {
            background: #ef4444;
            color: white;
        }

        .stop-btn:hover {
            background: #dc2626;
        }

        .detection-results {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 0.75rem;
            padding: 2rem;
            text-align: center;
        }

        .gesture-icon {
            margin-bottom: 1rem;
            display: flex;
            justify-content: center;
        }

        .gesture-name {
            font-size: 2rem;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .confidence-container {
            margin-top: 1.5rem;
        }

        .confidence-header {
            display: flex;
            justify-content: space-between;
            font-size: 0.875rem;
            color: #93c5fd;
            margin-bottom: 0.5rem;
        }

        .confidence-bar {
            width: 100%;
            height: 0.75rem;
            background: #374151;
            border-radius: 9999px;
            overflow: hidden;
        }

        .confidence-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6 0%, #8b5cf6 100%);
            transition: width 0.3s;
            border-radius: 9999px;
        }

        .gesture-list {
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .gesture-item {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.5rem;
            padding: 0.75rem;
            transition: all 0.2s;
        }

        .gesture-item.active {
            background: rgba(168, 85, 247, 0.3);
            border-color: rgba(192, 132, 252, 0.4);
        }

        .gesture-item p:first-child {
            font-weight: 600;
        }

        .gesture-item p:last-child {
            font-size: 0.875rem;
            color: #93c5fd;
        }

        .instructions {
            margin-top: 2rem;
        }

        .instructions h3 {
            font-size: 1.25rem;
            font-weight: 600;
            margin-bottom: 0.75rem;
        }

        .instructions ol {
            list-style-position: inside;
            color: #93c5fd;
        }

        .instructions li {
            margin-bottom: 0.5rem;
        }

        .icon {
            width: 1.25rem;
            height: 1.25rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12 2v8M12 2l4 4M12 2L8 6M4 14h16M2 18h20M12 22v-8M12 22l4-4M12 22l-4-4"/>
                </svg>
                Hand Gesture Detector
            </h1>
            <p>Real-time hand action recognition using your webcam</p>
        </div>

        <div class="grid">
            <!-- Video Feed -->
            <div class="card">
                <h2>Camera Feed</h2>
                <div class="video-container">
                    <video id="videoElement" playsinline muted></video>
                    <canvas id="canvasElement"></canvas>
                    <div id="videoPlaceholder" class="video-placeholder">
                        <svg class="icon" width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M15 12h6m-6 0-2-2m2 2-2 2M2 12c0-3.771 0-5.657 1.172-6.828C4.343 4 6.229 4 10 4h4c3.771 0 5.657 0 6.828 1.172C22 6.343 22 8.229 22 12c0 3.771 0 5.657-1.172 6.828C19.657 20 17.771 20 14 20h-4c-3.771 0-5.657 0-6.828-1.172C2 17.657 2 15.771 2 12Z"/>
                        </svg>
                    </div>
                </div>

                <div id="errorMessage" class="error-message hidden">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <line x1="12" y1="8" x2="12" y2="12"/>
                        <line x1="12" y1="16" x2="12.01" y2="16"/>
                    </svg>
                    <p>Camera access denied. Please allow camera permissions.</p>
                </div>

                <div class="button-group">
                    <button id="startBtn" class="start-btn">
                        <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M15 12h6m-6 0-2-2m2 2-2 2M2 12c0-3.771 0-5.657 1.172-6.828C4.343 4 6.229 4 10 4h4c3.771 0 5.657 0 6.828 1.172C22 6.343 22 8.229 22 12c0 3.771 0 5.657-1.172 6.828C19.657 20 17.771 20 14 20h-4c-3.771 0-5.657 0-6.828-1.172C2 17.657 2 15.771 2 12Z"/>
                        </svg>
                        Start Detection
                    </button>
                    <button id="stopBtn" class="stop-btn" style="display: none;">
                        Stop Detection
                    </button>
                </div>
            </div>

            <!-- Detection Results -->
            <div class="space-y-6">
                <div class="card">
                    <h2>Detected Gesture</h2>
                    <div class="detection-results">
                        <div id="gestureIcon" class="gesture-icon">
                            <svg class="icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3">
                                <path d="M12 2v8M12 2l4 4M12 2L8 6M4 14h16M2 18h20M12 22v-8M12 22l4-4M12 22l-4-4"/>
                            </svg>
                        </div>
                        <p id="gestureName" class="gesture-name">None</p>
                        <div class="confidence-container">
                            <div class="confidence-header">
                                <span>Confidence</span>
                                <span id="confidenceValue">0%</span>
                            </div>
                            <div class="confidence-bar">
                                <div id="confidenceFill" class="confidence-fill" style="width: 0%;"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Supported Gestures -->
                <div class="card">
                    <h2>Supported Gestures</h2>
                    <div class="gesture-list">
                        <div class="gesture-item" data-gesture="Open Palm">
                            <p>Open Palm</p>
                            <p>Show your open hand to the camera</p>
                        </div>
                        <div class="gesture-item" data-gesture="Fist">
                            <p>Fist</p>
                            <p>Make a closed fist</p>
                        </div>
                        <div class="gesture-item" data-gesture="Pointing">
                            <p>Pointing</p>
                            <p>Point with your index finger</p>
                        </div>
                        <div class="gesture-item" data-gesture="Peace Sign">
                            <p>Peace Sign</p>
                            <p>Show two fingers in a V shape</p>
                        </div>
                        <div class="gesture-item" data-gesture="Thumbs Up">
                            <p>Thumbs Up</p>
                            <p>Give a thumbs up gesture</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="instructions card">
            <h3>How to Use</h3>
            <ol>
                <li>Click "Start Detection" to activate your webcam</li>
                <li>Position your hand clearly in front of the camera</li>
                <li>Try different hand gestures and see them detected in real-time</li>
                <li>Make sure you have good lighting for best results</li>
            </ol>
        </div>
    </div>

    <script>
        // Initialize Lucide icons
        lucide.createIcons();

        // DOM Elements
        const videoElement = document.getElementById('videoElement');
        const canvasElement = document.getElementById('canvasElement');
        const videoPlaceholder = document.getElementById('videoPlaceholder');
        const startBtn = document.getElementById('startBtn');
        const stopBtn = document.getElementById('stopBtn');
        const errorMessage = document.getElementById('errorMessage');
        const gestureIcon = document.getElementById('gestureIcon');
        const gestureName = document.getElementById('gestureName');
        const confidenceValue = document.getElementById('confidenceValue');
        const confidenceFill = document.getElementById('confidenceFill');
        const gestureItems = document.querySelectorAll('.gesture-item');

        // State variables
        let isActive = false;
        let animationId = null;
        let currentGesture = 'None';
        let currentConfidence = 0;

        // Gesture icons
        const gestureIcons = {
            'Open Palm': `<svg class="icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M12 2v8M12 2l4 4M12 2L8 6M4 14h16M2 18h20M12 22v-8M12 22l4-4M12 22l-4-4"/>
            </svg>`,
            'Fist': `<svg class="icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
            </svg>`,
            'Pointing': `<svg class="icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M5 12h14M12 5l7 7-7 7"/>
            </svg>`,
            'Peace Sign': `<svg class="icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <rect x="3" y="3" width="18" height="18" rx="2"/>
            </svg>`,
            'Thumbs Up': `<svg class="icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <circle cx="12" cy="12" r="10"/>
                <path d="m9 12 2 2 4-4"/>
            </svg>`,
            'None': `<svg class="icon" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" opacity="0.3">
                <path d="M12 2v8M12 2l4 4M12 2L8 6M4 14h16M2 18h20M12 22v-8M12 22l4-4M12 22l-4-4"/>
            </svg>`
        };

        // Start detection
        startBtn.addEventListener('click', async () => {
            try {
                errorMessage.classList.add('hidden');
                
                const stream = await navigator.mediaDevices.getUserMedia({
                    video: {
                        facingMode: 'user',
                        width: { ideal: 640 },
                        height: { ideal: 480 }
                    }
                });
                
                videoElement.srcObject = stream;
                videoElement.style.display = 'block';
                videoPlaceholder.style.display = 'none';
                
                videoElement.onloadedmetadata = () => {
                    videoElement.play();
                    isActive = true;
                    startBtn.style.display = 'none';
                    stopBtn.style.display = 'flex';
                    detectGesture();
                };
            } catch (err) {
                console.error('Camera error:', err);
                errorMessage.classList.remove('hidden');
                stopDetection();
            }
        });

        // Stop detection
        stopBtn.addEventListener('click', stopDetection);

        function stopDetection() {
            if (videoElement.srcObject) {
                const tracks = videoElement.srcObject.getTracks();
                tracks.forEach(track => track.stop());
                videoElement.srcObject = null;
                videoElement.style.display = 'none';
                videoPlaceholder.style.display = 'flex';
            }
            
            if (animationId) {
                cancelAnimationFrame(animationId);
                animationId = null;
            }
            
            isActive = false;
            startBtn.style.display = 'flex';
            stopBtn.style.display = 'none';
            
            // Reset UI
            updateGesture('None', 0);
        }

        // Detect gesture (simulated for demo)
        function detectGesture() {
            if (!isActive) return;
            
            const ctx = canvasElement.getContext('2d');
            canvasElement.width = videoElement.videoWidth || 640;
            canvasElement.height = videoElement.videoHeight || 480;
            
            // Draw video frame to canvas
            ctx.drawImage(videoElement, 0, 0, canvasElement.width, canvasElement.height);
            
            // Simulate gesture detection
            const simulatedGestures = [
                { name: 'Open Palm', confidence: Math.floor(Math.random() * 30) + 70 },
                { name: 'Fist', confidence: Math.floor(Math.random() * 30) + 70 },
                { name: 'Pointing', confidence: Math.floor(Math.random() * 30) + 70 },
                { name: 'Peace Sign', confidence: Math.floor(Math.random() * 30) + 70 },
                { name: 'Thumbs Up', confidence: Math.floor(Math.random() * 30) + 70 },
                { name: 'None', confidence: 0 }
            ];
            
            // Randomly select a gesture for demo (in real app, this would be actual detection)
            const gesture = Math.random() > 0.3 ? 
                simulatedGestures[Math.floor(Math.random() * 5)] : 
                simulatedGestures[5];
            
            updateGesture(gesture.name, gesture.confidence);
            
            // Continue detection loop
            animationId = requestAnimationFrame(detectGesture);
        }

        function updateGesture(name, confidence) {
            currentGesture = name;
            currentConfidence = confidence;
            
            // Update UI
            gestureIcon.innerHTML = gestureIcons[name] || gestureIcons['None'];
            gestureName.textContent = name;
            confidenceValue.textContent = confidence + '%';
            confidenceFill.style.width = confidence + '%';
            
            // Update active state in gesture list
            gestureItems.forEach(item => {
                if (item.dataset.gesture === name) {
                    item.classList.add('active');
                } else {
                    item.classList.remove('active');
                }
            });
        }

        // Clean up on page unload
        window.addEventListener('beforeunload', stopDetection);
    </script>
</body>
</html>